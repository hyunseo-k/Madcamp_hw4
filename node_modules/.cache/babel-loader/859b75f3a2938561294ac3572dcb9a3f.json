{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\(S)samsungFLEX5\\\\Desktop\\\\hw4_login\\\\src\\\\pages\\\\game\\\\components\\\\Timer.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport TimerStyle from './Timer.style';\nimport timerConfig from '../../../constants/timerConfig';\nimport GamePlayContext from './GamePlay/GamePlay.context';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nTimer.propTypes = {\n  isTimerGetReady: PropTypes.bool.isRequired,\n  endTime: PropTypes.number.isRequired\n};\nconst getRemainTime = endTime => {\n  const gap = Math.floor((endTime - Date.now()) / 1000);\n  return gap >= 0 ? gap : 0;\n};\nexport default function Timer({\n  isTimerGetReady,\n  endTime\n}) {\n  _s();\n  const {\n    gameStateDispatch\n  } = useContext(GamePlayContext);\n  const [remainTime, setRemainTime] = useState(getRemainTime(endTime));\n  const requestId = useRef(0);\n  useEffect(() => {\n    const resetTimer = () => {\n      setRemainTime(getRemainTime(Date.now() + timerConfig.defaultExpireTime));\n    };\n    const countDown = () => {\n      setRemainTime(getRemainTime(endTime));\n      if (getRemainTime(endTime) <= 10) gameStateDispatch({\n        type: 'setIsLetterOpen',\n        isLetterOpen: true\n      });\n      if (isTimerGetReady) requestId.current = requestAnimationFrame(countDown);\n    };\n    if (isTimerGetReady) requestId.current = requestAnimationFrame(countDown);else resetTimer();\n    return () => {\n      cancelAnimationFrame(requestId.current);\n    };\n  }, [endTime, isTimerGetReady, gameStateDispatch]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(TimerStyle, {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: remainTime\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n_s(Timer, \"cfc2D7VwC8zG5CSQnZNtbQONl6A=\");\n_c = Timer;\nvar _c;\n$RefreshReg$(_c, \"Timer\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useContext","PropTypes","TimerStyle","timerConfig","GamePlayContext","jsxDEV","_jsxDEV","Fragment","_Fragment","Timer","propTypes","isTimerGetReady","bool","isRequired","endTime","number","getRemainTime","gap","Math","floor","Date","now","_s","gameStateDispatch","remainTime","setRemainTime","requestId","resetTimer","defaultExpireTime","countDown","type","isLetterOpen","current","requestAnimationFrame","cancelAnimationFrame","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/(S)samsungFLEX5/Desktop/hw4_login/src/pages/game/components/Timer.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useContext } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport TimerStyle from './Timer.style';\r\nimport timerConfig from '../../../constants/timerConfig';\r\nimport GamePlayContext from './GamePlay/GamePlay.context';\r\n\r\nTimer.propTypes = {\r\n  isTimerGetReady: PropTypes.bool.isRequired,\r\n  endTime: PropTypes.number.isRequired,\r\n};\r\n\r\nconst getRemainTime = (endTime) => {\r\n  const gap = Math.floor((endTime - Date.now()) / 1000);\r\n  return gap >= 0 ? gap : 0;\r\n};\r\n\r\nexport default function Timer({ isTimerGetReady, endTime }) {\r\n  const { gameStateDispatch } = useContext(GamePlayContext);\r\n  const [remainTime, setRemainTime] = useState(getRemainTime(endTime));\r\n  const requestId = useRef(0);\r\n\r\n  useEffect(() => {\r\n    const resetTimer = () => {\r\n      setRemainTime(getRemainTime(Date.now() + timerConfig.defaultExpireTime));\r\n    };\r\n\r\n    const countDown = () => {\r\n      setRemainTime(getRemainTime(endTime));\r\n      if (getRemainTime(endTime) <= 10)\r\n        gameStateDispatch({ type: 'setIsLetterOpen', isLetterOpen: true });\r\n      if (isTimerGetReady) requestId.current = requestAnimationFrame(countDown);\r\n    };\r\n\r\n    if (isTimerGetReady) requestId.current = requestAnimationFrame(countDown);\r\n    else resetTimer();\r\n\r\n    return () => {\r\n      cancelAnimationFrame(requestId.current);\r\n    };\r\n  }, [endTime, isTimerGetReady, gameStateDispatch]);\r\n\r\n  return (\r\n    <>\r\n      <TimerStyle>\r\n        <span>{remainTime}</span>\r\n      </TimerStyle>\r\n    </>\r\n  );\r\n}"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,EAAEC,UAAU,QAAQ,OAAO;AACtE,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,UAAU,MAAM,eAAe;AACtC,OAAOC,WAAW,MAAM,gCAAgC;AACxD,OAAOC,eAAe,MAAM,6BAA6B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAE1DC,KAAK,CAACC,SAAS,GAAG;EAChBC,eAAe,EAAEV,SAAS,CAACW,IAAI,CAACC,UAAU;EAC1CC,OAAO,EAAEb,SAAS,CAACc,MAAM,CAACF;AAC5B,CAAC;AAED,MAAMG,aAAa,GAAIF,OAAO,IAAK;EACjC,MAAMG,GAAG,GAAGC,IAAI,CAACC,KAAK,CAAC,CAACL,OAAO,GAAGM,IAAI,CAACC,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC;EACrD,OAAOJ,GAAG,IAAI,CAAC,GAAGA,GAAG,GAAG,CAAC;AAC3B,CAAC;AAED,eAAe,SAASR,KAAKA,CAAC;EAAEE,eAAe;EAAEG;AAAQ,CAAC,EAAE;EAAAQ,EAAA;EAC1D,MAAM;IAAEC;EAAkB,CAAC,GAAGvB,UAAU,CAACI,eAAe,CAAC;EACzD,MAAM,CAACoB,UAAU,EAAEC,aAAa,CAAC,GAAG5B,QAAQ,CAACmB,aAAa,CAACF,OAAO,CAAC,CAAC;EACpE,MAAMY,SAAS,GAAG3B,MAAM,CAAC,CAAC,CAAC;EAE3BD,SAAS,CAAC,MAAM;IACd,MAAM6B,UAAU,GAAGA,CAAA,KAAM;MACvBF,aAAa,CAACT,aAAa,CAACI,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGlB,WAAW,CAACyB,iBAAiB,CAAC,CAAC;IAC1E,CAAC;IAED,MAAMC,SAAS,GAAGA,CAAA,KAAM;MACtBJ,aAAa,CAACT,aAAa,CAACF,OAAO,CAAC,CAAC;MACrC,IAAIE,aAAa,CAACF,OAAO,CAAC,IAAI,EAAE,EAC9BS,iBAAiB,CAAC;QAAEO,IAAI,EAAE,iBAAiB;QAAEC,YAAY,EAAE;MAAK,CAAC,CAAC;MACpE,IAAIpB,eAAe,EAAEe,SAAS,CAACM,OAAO,GAAGC,qBAAqB,CAACJ,SAAS,CAAC;IAC3E,CAAC;IAED,IAAIlB,eAAe,EAAEe,SAAS,CAACM,OAAO,GAAGC,qBAAqB,CAACJ,SAAS,CAAC,CAAC,KACrEF,UAAU,CAAC,CAAC;IAEjB,OAAO,MAAM;MACXO,oBAAoB,CAACR,SAAS,CAACM,OAAO,CAAC;IACzC,CAAC;EACH,CAAC,EAAE,CAAClB,OAAO,EAAEH,eAAe,EAAEY,iBAAiB,CAAC,CAAC;EAEjD,oBACEjB,OAAA,CAAAE,SAAA;IAAA2B,QAAA,eACE7B,OAAA,CAACJ,UAAU;MAAAiC,QAAA,eACT7B,OAAA;QAAA6B,QAAA,EAAOX;MAAU;QAAAY,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACf;EAAC,gBACb,CAAC;AAEP;AAACjB,EAAA,CAhCuBb,KAAK;AAAA+B,EAAA,GAAL/B,KAAK;AAAA,IAAA+B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module"}